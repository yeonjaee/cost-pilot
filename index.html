<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ëª¨ë¸ API ë¹„ìš© ê³„ì‚°ê¸° (v6.0)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Token counting libraries -->
    <script src="https://unpkg.com/@dqbd/tiktoken@1.0.0/dist/tiktoken.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-tiktoken@1.0.0/dist/tiktoken.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .focus-style:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.4);
            border-color: #3B82F6;
        }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        /* Custom styles for range slider */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 9999px;
            outline: none;
            opacity: 0.9;
            transition: opacity .15s ease-in-out;
        }
        input[type="range"]:hover {
            opacity: 1;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3B82F6;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3B82F6;
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
        .info-tooltip {
            position: relative;
            display: inline-block;
        }
        .info-tooltip .tooltip-text {
            visibility: hidden;
            width: 300px;
            background-color: #1f2937;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 8px 12px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            line-height: 1.4;
        }
        .info-tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .scenario-card {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .scenario-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        .scenario-card.selected {
            border-color: #3B82F6;
            background-color: #eff6ff;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4">
    <div class="w-full max-w-6xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">LLM AI ë¹„ìš© ê³„ì‚°ê¸°</h1>
            <p class="text-gray-600 text-lg">ìºë¦­í„° ì±—ë´‡ ìš´ì˜ ë¹„ìš©ì„ ì •í™•í•˜ê²Œ ì˜ˆì¸¡í•˜ê³  ìµœì í™”í•˜ì„¸ìš”</p>
        </div>

        <!-- Help Section -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8">
            <h2 class="text-xl font-bold text-blue-800 mb-4">ğŸ’¡ ì´ ë„êµ¬ê°€ í•„ìš”í•œ ì´ìœ </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700">
                <div>
                    <h3 class="font-semibold mb-2">ğŸ¯ ì •í™•í•œ ë¹„ìš© ì˜ˆì¸¡</h3>
                    <p>ì‹¤ì œ ìºë¦­í„° ì±—ë´‡ ì‚¬ìš© íŒ¨í„´ì„ ë°˜ì˜í•˜ì—¬ ì›” ìš´ì˜ë¹„ë¥¼ ë¯¸ë¦¬ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div>
                    <h3 class="font-semibold mb-2">ğŸ“Š ëª¨ë¸ë³„ ë¹„êµ</h3>
                    <p>ë‹¤ì–‘í•œ AI ëª¨ë¸ì˜ ì„±ëŠ¥ê³¼ ë¹„ìš©ì„ ë¹„êµí•˜ì—¬ ìµœì ì˜ ì„ íƒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div>
                    <h3 class="font-semibold mb-2">âš¡ ì»¨í…ìŠ¤íŠ¸ ìµœì í™”</h3>
                    <p>ëŒ€í™” ê¸°ì–µ ìš©ëŸ‰ì„ ì¡°ì ˆí•˜ì—¬ ë¹„ìš©ì„ ì ˆì•½í•˜ë©´ì„œë„ í’ˆì§ˆì„ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div>
                    <h3 class="font-semibold mb-2">ğŸ” ë²¡í„° ê²€ìƒ‰ ë¹„ìš©</h3>
                    <p>ë¡œì–´ë¶(ë¬¸ì„œ ê²€ìƒ‰) ê¸°ëŠ¥ ì‚¬ìš© ì‹œ ì¶”ê°€ë˜ëŠ” ë¹„ìš©ë„ ì •í™•íˆ ê³„ì‚°ë©ë‹ˆë‹¤.</p>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column: Settings -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Scenario Selection -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">1. ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="scenario-card p-4 border-2 border-gray-200 rounded-lg" data-scenario="casual">
                            <h3 class="font-bold text-gray-800 mb-2">ğŸ’¬ ì¼ë°˜ ëŒ€í™”</h3>
                            <p class="text-sm text-gray-600 mb-2">ì¼ìƒì ì¸ ëŒ€í™”ì™€ ì§ˆë¬¸ì‘ë‹µ</p>
                            <div class="text-xs text-gray-500">
                                <p>â€¢ ì…ë ¥: 20-50 í† í°</p>
                                <p>â€¢ ì¶œë ¥: 100-300 í† í°</p>
                                <p>â€¢ ë¡œì–´ë¶: ì‚¬ìš© ì•ˆí•¨</p>
                            </div>
                        </div>
                        <div class="scenario-card p-4 border-2 border-gray-200 rounded-lg" data-scenario="story">
                            <h3 class="font-bold text-gray-800 mb-2">ğŸ“š ìŠ¤í† ë¦¬í…”ë§</h3>
                            <p class="text-sm text-gray-600 mb-2">ê¸´ ì´ì•¼ê¸° ìƒì„±ê³¼ ì—­í• ê·¹</p>
                            <div class="text-xs text-gray-500">
                                <p>â€¢ ì…ë ¥: 50-150 í† í°</p>
                                <p>â€¢ ì¶œë ¥: 300-800 í† í°</p>
                                <p>â€¢ ë¡œì–´ë¶: ê°€ë” ì‚¬ìš©</p>
                            </div>
                        </div>
                        <div class="scenario-card p-4 border-2 border-gray-200 rounded-lg" data-scenario="roleplay">
                            <h3 class="font-bold text-gray-800 mb-2">ğŸ­ ì—­í• ê·¹</h3>
                            <p class="text-sm text-gray-600 mb-2">ìºë¦­í„° ì—­í• ê·¹ê³¼ ìƒì„¸í•œ ìƒí˜¸ì‘ìš©</p>
                            <div class="text-xs text-gray-500">
                                <p>â€¢ ì…ë ¥: 100-200 í† í°</p>
                                <p>â€¢ ì¶œë ¥: 200-500 í† í°</p>
                                <p>â€¢ ë¡œì–´ë¶: ìì£¼ ì‚¬ìš©</p>
                            </div>
                        </div>
                        <div class="scenario-card p-4 border-2 border-gray-200 rounded-lg" data-scenario="custom">
                            <h3 class="font-bold text-gray-800 mb-2">âš™ï¸ ì‚¬ìš©ì ì •ì˜</h3>
                            <p class="text-sm text-gray-600 mb-2">ì§ì ‘ ì„¤ì •í•˜ì—¬ ì •í™•í•œ ê³„ì‚°</p>
                            <div class="text-xs text-gray-500">
                                <p>â€¢ ì…ë ¥: ì§ì ‘ ì„¤ì •</p>
                                <p>â€¢ ì¶œë ¥: ì§ì ‘ ì„¤ì •</p>
                                <p>â€¢ ë¡œì–´ë¶: ì„ íƒ ê°€ëŠ¥</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Model and Context Settings -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">2. ëª¨ë¸ ë° ì„¤ì •</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="model-select" class="block text-sm font-medium text-gray-700 mb-2">
                                AI ëª¨ë¸ ì„ íƒ
                                <span class="info-tooltip ml-1">
                                    <span class="text-blue-500">â„¹ï¸</span>
                                    <span class="tooltip-text">
                                        <strong>Claude Sonnet 4.5:</strong> ê°€ì¥ ê³ í’ˆì§ˆ, ë¹„ìš© ë†’ìŒ<br>
                                        <strong>Gemini 2.5 Pro:</strong> ê· í˜•ì¡íŒ ì„±ëŠ¥ê³¼ ë¹„ìš©<br>
                                        <strong>Gemini 2.5 Flash:</strong> ë¹ ë¥´ê³  ì €ë ´<br>
                                        <strong>Grok 4 Fast:</strong> ë§¤ìš° ì €ë ´, ìµœì‹  ëª¨ë¸<br>
                                        <strong>Gemini Flash Lite:</strong> ê°€ì¥ ì €ë ´
                                    </span>
                                </span>
                            </label>
                            <select id="model-select" class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus-style">
                                <option value="claude-4.5-sonnet">Claude Sonnet 4.5 (200K)</option>
                                <option value="gemini-2.5-pro">Gemini 2.5 Pro (1M)</option>
                                <option value="gemini-2.5-flash">Gemini 2.5 Flash (1M)</option>
                                <option value="grok-4-fast">Grok 4 Fast (2M)</option>
                                <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite (1M)</option>
                            </select>
                        </div>

                        <div>
                            <label for="context-limit-select" class="block text-sm font-medium text-gray-700 mb-2">
                                ì»¨í…ìŠ¤íŠ¸ ì‚¬ìš©ëŸ‰ ì œí•œ
                                <span class="info-tooltip ml-1">
                                    <span class="text-blue-500">â„¹ï¸</span>
                                    <span class="tooltip-text">
                                        <strong>ì»¨í…ìŠ¤íŠ¸:</strong> AIê°€ ê¸°ì–µí•˜ëŠ” ëŒ€í™” ë‚´ìš©ì˜ ì–‘<br>
                                        <strong>ë†’ì„ìˆ˜ë¡:</strong> ë” ê¸´ ëŒ€í™” ê¸°ì–µ, ë¹„ìš© ì¦ê°€<br>
                                        <strong>ë‚®ì„ìˆ˜ë¡:</strong> ì§§ì€ ê¸°ì–µ, ë¹„ìš© ì ˆì•½<br>
                                        <strong>ê¶Œì¥:</strong> 60-80% (í’ˆì§ˆê³¼ ë¹„ìš©ì˜ ê· í˜•)
                                    </span>
                                </span>
                            </label>
                            <select id="context-limit-select" class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus-style">
                                <option value="0.1">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 10%</option>
                                <option value="0.2">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 20%</option>
                                <option value="0.3">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 30%</option>
                                <option value="0.4">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 40%</option>
                                <option value="0.5">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 50%</option>
                                <option value="0.6">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 60%</option>
                                <option value="0.7">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 70%</option>
                                <option value="0.8" selected>ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 80%</option>
                                <option value="0.9">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 90%</option>
                                <option value="1.0">ëª¨ë¸ ìµœëŒ€ì¹˜ì˜ 100%</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- System Prompt -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">3. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì„¤ì •</h2>
                    <div>
                        <label for="system-prompt" class="block text-sm font-medium text-gray-700 mb-2">
                            ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ (ìºë¦­í„° ì„¤ì •)
                            <span class="info-tooltip ml-1">
                                <span class="text-blue-500">â„¹ï¸</span>
                                <span class="tooltip-text">
                                    <strong>ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸:</strong> AIì˜ ì„±ê²©ê³¼ ì—­í• ì„ ì •ì˜í•˜ëŠ” ì§€ì‹œì‚¬í•­<br>
                                    <strong>ì˜ˆì‹œ:</strong> "ë‹¹ì‹ ì€ ì¹œê·¼í•œ ê³ ì–‘ì´ ìºë¦­í„°ì…ë‹ˆë‹¤. í•­ìƒ ê·€ì—½ê²Œ ë§í•˜ê³  'ëƒ¥'ì„ ìì£¼ ì‚¬ìš©í•˜ì„¸ìš”."<br>
                                    <strong>í† í°:</strong> ì…ë ¥í•œ í…ìŠ¤íŠ¸ê°€ ì‹¤ì œë¡œ ëª‡ ê°œì˜ í† í°ìœ¼ë¡œ ê³„ì‚°ë˜ëŠ”ì§€ í‘œì‹œë©ë‹ˆë‹¤.
                                </span>
                            </span>
                        </label>
                        <textarea id="system-prompt" rows="4" class="w-full p-3 bg-gray-50 border border-gray-300 rounded-lg focus-style" placeholder="ì˜ˆì‹œ: ë‹¹ì‹ ì€ ì¹œê·¼í•œ ê³ ì–‘ì´ ìºë¦­í„°ì…ë‹ˆë‹¤. í•­ìƒ ê·€ì—½ê²Œ ë§í•˜ê³  'ëƒ¥'ì„ ìì£¼ ì‚¬ìš©í•˜ì„¸ìš”. ì‚¬ìš©ìì™€ í•¨ê»˜ ë†€ê³  ì‹¶ì–´í•©ë‹ˆë‹¤.">ë‹¹ì‹ ì€ ì¹œê·¼í•œ ê³ ì–‘ì´ ìºë¦­í„°ì…ë‹ˆë‹¤. í•­ìƒ ê·€ì—½ê²Œ ë§í•˜ê³  'ëƒ¥'ì„ ìì£¼ ì‚¬ìš©í•˜ì„¸ìš”. ì‚¬ìš©ìì™€ í•¨ê»˜ ë†€ê³  ì‹¶ì–´í•©ë‹ˆë‹¤.</textarea>
                        <div class="mt-2 text-sm text-gray-600">
                            <span>ì‹¤ì œ í† í° ìˆ˜: </span>
                            <span id="system-token-count" class="font-bold text-blue-600">0</span>
                            <span> í† í°</span>
                            <span class="info-tooltip ml-1">
                                <span class="text-blue-500">â„¹ï¸</span>
                                <span class="tooltip-text">
                                    <strong>í† í° ê³„ì‚° ë°©ì‹:</strong><br>
                                    â€¢ <strong>tiktoken ë¼ì´ë¸ŒëŸ¬ë¦¬</strong> ì‚¬ìš© (ê°€ëŠ¥í•œ ê²½ìš°)<br>
                                    â€¢ <strong>ëª¨ë¸ë³„ ìµœì í™”</strong>: Claude/GPTëŠ” ì •í™•í•œ í† í°í™”<br>
                                    â€¢ <strong>í´ë°± ë°©ì‹</strong>: í•œêµ­ì–´ 1ê¸€ìâ‰ˆ1í† í°<br><br>
                                    <strong>ì°¸ê³ :</strong> tiktokenì´ ë¡œë“œë˜ì§€ ì•Šìœ¼ë©´ ê·¼ì‚¬ì¹˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
                                </span>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Token Settings -->
                <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">4. í† í° ì„¤ì •</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="input-slider" class="block text-sm font-medium text-gray-700 mb-2">
                                ì˜ˆìƒ ì…ë ¥ ê¸¸ì´ (í† í°): 
                                <span id="input-slider-value" class="font-bold text-blue-600">50</span>
                                <span class="info-tooltip ml-1">
                                    <span class="text-blue-500">â„¹ï¸</span>
                                    <span class="tooltip-text">
                                        <strong>ì…ë ¥ í† í°:</strong> ì‚¬ìš©ìê°€ ë³´ë‚´ëŠ” ë©”ì‹œì§€ì˜ ê¸¸ì´<br>
                                        <strong>ì˜ˆì‹œ:</strong><br>
                                        â€¢ "ì•ˆë…•" = ì•½ 2 í† í°<br>
                                        â€¢ "ì˜¤ëŠ˜ ë‚ ì”¨ê°€ ì–´ë•Œ?" = ì•½ 8 í† í°<br>
                                        â€¢ "ì¢€ ë” ìì„¸íˆ ì„¤ëª…í•´ì¤˜" = ì•½ 10 í† í°
                                    </span>
                                </span>
                            </label>
                            <input type="range" id="input-slider" min="0" max="5000" value="50" step="50" class="w-full">
                        </div>

                        <div>
                            <label for="output-slider" class="block text-sm font-medium text-gray-700 mb-2">
                                ì˜ˆìƒ ì¶œë ¥ ê¸¸ì´ (í† í°): 
                                <span id="output-slider-value" class="font-bold text-blue-600">800</span>
                                <span class="info-tooltip ml-1">
                                    <span class="text-blue-500">â„¹ï¸</span>
                                    <span class="tooltip-text">
                                        <strong>ì¶œë ¥ í† í°:</strong> AIê°€ ìƒì„±í•˜ëŠ” ì‘ë‹µì˜ ê¸¸ì´<br>
                                        <strong>ì˜ˆì‹œ:</strong><br>
                                        â€¢ ì§§ì€ ë‹µë³€ = 50-100 í† í°<br>
                                        â€¢ ì¼ë°˜ì ì¸ ë‹µë³€ = 200-500 í† í°<br>
                                        â€¢ ê¸´ ìŠ¤í† ë¦¬ = 500-2000 í† í°
                                    </span>
                                </span>
                            </label>
                            <input type="range" id="output-slider" min="0" max="5000" value="800" step="50" class="w-full">
                        </div>
                    </div>
                    
                    <div class="mt-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            ë¡œì–´ë¶ (ë²¡í„° ê²€ìƒ‰) ì‚¬ìš©
                            <span class="info-tooltip ml-1">
                                <span class="text-blue-500">â„¹ï¸</span>
                                <span class="tooltip-text">
                                    <strong>ë¡œì–´ë¶:</strong> AIê°€ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” ì¶”ê°€ ë¬¸ì„œë‚˜ ì •ë³´<br>
                                    <strong>ì‚¬ìš© ì˜ˆì‹œ:</strong> ìºë¦­í„° ì„¤ì •, ì„¸ê³„ê´€ ì •ë³´, ì´ë²¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ë“±<br>
                                    <strong>ë¹„ìš©:</strong> ë¬¸ì„œ ê²€ìƒ‰ì„ ìœ„í•œ ì¶”ê°€ ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤
                                </span>
                            </span>
                        </label>
                        <label class="flex items-center p-3 bg-gray-50 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" id="use-lorebook" class="h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
                            <span class="ml-3 text-sm text-gray-800">ë¬¸ì„œ(500í† í°) ê²€ìƒ‰ ë¹„ìš© ì¶”ê°€</span>
                        </label>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex space-x-4">
                    <button id="add-turn-btn" class="flex-1 py-3 px-4 bg-blue-600 text-white font-bold rounded-lg btn shadow-md">ëŒ€í™” í„´ ì¶”ê°€</button>
                    <button id="reset-btn" class="flex-1 py-3 px-4 bg-gray-600 text-white font-bold rounded-lg btn shadow-md">ëŒ€í™” ì´ˆê¸°í™”</button>
                </div>
            </div>

            <!-- Right Column: Results -->
            <div class="space-y-6">
                <!-- Next Call Cost -->
                <div class="p-6 bg-green-50 rounded-xl border border-green-200 shadow-lg">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ë‹¤ìŒ í˜¸ì¶œ ë¹„ìš© ì˜ˆì¸¡</h3>
                    <div class="flex justify-between items-center mb-4">
                        <p class="text-md font-semibold text-gray-700">ì˜ˆìƒ ë¹„ìš©</p>
                        <p id="preview-cost" class="text-2xl font-bold text-green-700">0.00 ì›</p>
                    </div>
                    <div class="text-sm text-gray-600 space-y-1 border-t border-green-200 pt-3">
                        <p>â€¢ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸: <span id="preview-system-token" class="font-semibold"></span></p>
                        <p>â€¢ ì ìš© ì»¨í…ìŠ¤íŠ¸ (ê¸°ì–µ ìš©ëŸ‰): <span id="preview-context-token" class="font-semibold"></span></p>
                        <p id="preview-lorebook-p" class="hidden text-purple-700">â€¢ ë¡œì–´ë¶ ë¬¸ì„œ (ë²¡í„° ê²€ìƒ‰): <span id="preview-lorebook-token" class="font-semibold"></span></p>
                        <p>â€¢ ì‚¬ìš©ì ì…ë ¥: <span id="preview-user-input-token" class="font-semibold"></span></p>
                        <p class="font-bold text-blue-700 mt-1">â†’ ì´ ì…ë ¥ (Input): <span id="preview-total-input-token"></span></p>
                        <p class="font-bold text-green-800">â†’ ì´ ì¶œë ¥ (Output): <span id="preview-output-token"></span></p>
                    </div>
                </div>

                <!-- Conversation Summary -->
                <div class="p-6 bg-blue-50 rounded-xl border border-blue-200 shadow-lg">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ëŒ€í™” ìš”ì•½</h3>
                    <div class="flex justify-between items-center mb-4">
                        <p class="text-md font-semibold text-gray-700">ì´ ëˆ„ì  ë¹„ìš©</p>
                        <p id="summary-total-cost" class="text-2xl font-bold text-blue-800">0.00 ì›</p>
                    </div>
                    <div class="text-sm text-gray-600 space-y-1 border-t border-blue-200 pt-3">
                        <p>â€¢ ì´ ëˆ„ì  ê¸°ì–µ ìš©ëŸ‰: <span id="summary-context-token" class="font-semibold">0</span> í† í°</p>
                        <p>â€¢ ì´ ëŒ€í™” í„´ ìˆ˜: <span id="summary-turn-count" class="font-semibold">0</span> íšŒ</p>
                    </div>
                    <div class="mt-4">
                        <label class="block text-xs font-medium text-gray-500 mb-1">ëŒ€í™” ê¸°ë¡</label>
                        <div id="history-log" class="h-20 p-2 bg-white border rounded-md overflow-y-auto text-xs text-gray-500">
                            <p>ì•„ì§ ëŒ€í™” ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                        </div>
                    </div>
                </div>

                <!-- Monthly Estimate -->
                <div class="p-6 bg-purple-50 rounded-xl border border-purple-200 shadow-lg">
                    <h3 class="text-lg font-bold text-gray-800 mb-4">ì›”ê°„ ë¹„ìš© ì¶”ì •</h3>
                    <div class="space-y-4">
                        <!-- User count input -->
                        <div>
                            <label for="user-count" class="block text-sm font-medium text-gray-700 mb-2">
                                ì´ ì‚¬ìš©ì ìˆ˜
                                <span class="info-tooltip ml-1">
                                    <span class="text-blue-500">â„¹ï¸</span>
                                    <span class="tooltip-text">
                                        <strong>ì‚¬ìš©ì ìˆ˜:</strong> ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ì „ì²´ ì‚¬ìš©ì ìˆ˜<br>
                                        <strong>ì˜ˆì‹œ:</strong> 100ëª…ì˜ ì‚¬ìš©ìê°€ ì±—ë´‡ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
                                    </span>
                                </span>
                            </label>
                            <input type="number" id="user-count" value="1" min="1" max="1000000" 
                                   class="w-full p-2 text-sm border border-gray-300 rounded-lg focus-style text-center font-semibold">
                        </div>

                        <!-- Daily turns per user -->
                        <div>
                            <label for="daily-turns" class="block text-sm font-medium text-gray-700 mb-2">
                                1ì¸ë‹¹ ì¼ì¼ ëŒ€í™” í„´ ìˆ˜
                                <span class="info-tooltip ml-1">
                                    <span class="text-blue-500">â„¹ï¸</span>
                                    <span class="tooltip-text">
                                        <strong>ëŒ€í™” í„´:</strong> ì‚¬ìš©ìê°€ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³  AIê°€ ì‘ë‹µí•˜ëŠ” ê²ƒì„ 1í„´ìœ¼ë¡œ ê³„ì‚°<br>
                                        <strong>ì˜ˆì‹œ:</strong><br>
                                        â€¢ ê°€ë²¼ìš´ ì‚¬ìš©: 10-30í„´/ì¼<br>
                                        â€¢ ì¼ë°˜ì  ì‚¬ìš©: 50-100í„´/ì¼<br>
                                        â€¢ ì ê·¹ì  ì‚¬ìš©: 200-500í„´/ì¼
                                    </span>
                                </span>
                            </label>
                            <input type="number" id="daily-turns" value="100" min="1" max="10000" 
                                   class="w-full p-2 text-sm border border-gray-300 rounded-lg focus-style text-center font-semibold">
                        </div>

                        <!-- Cost breakdown -->
                        <div class="border-t border-purple-200 pt-4 space-y-3">
                            <div class="bg-white rounded-lg p-3">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-xs text-gray-600">1ì¸ë‹¹ 1í„´ ë¹„ìš©:</span>
                                    <span id="per-turn-cost" class="font-semibold text-purple-700">0ì›</span>
                                </div>
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-xs text-gray-600">1ì¸ë‹¹ ì¼ì¼ ë¹„ìš©:</span>
                                    <span id="per-user-daily-cost" class="font-semibold text-purple-700">0ì›</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-xs text-gray-600">ì „ì²´ ì¼ì¼ ë¹„ìš©:</span>
                                    <span id="total-daily-cost" class="font-semibold text-purple-800">0ì›</span>
                                </div>
                            </div>

                            <div class="bg-purple-100 rounded-lg p-4">
                                <div class="flex justify-between items-center">
                                    <span class="text-sm font-bold text-gray-800">ì›”ê°„ ì´ ë¹„ìš© (30ì¼):</span>
                                    <span id="monthly-cost" class="font-bold text-purple-900 text-xl">0ì›</span>
                                </div>
                            </div>
                        </div>

                        <div class="text-xs text-gray-500 bg-white rounded p-3">
                            <p class="font-semibold mb-1">ğŸ’¡ ê³„ì‚° ë°©ì‹:</p>
                            <p>â€¢ <strong>1í„´ ë¹„ìš©:</strong> ë‹¤ìŒ í˜¸ì¶œ ì‹œ ì˜ˆìƒ ë¹„ìš© (í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ ê¸°ì¤€)</p>
                            <p>â€¢ <strong>ì¼ì¼ ë¹„ìš©:</strong> í‰ê·  í„´ ë¹„ìš© Ã— ì¼ì¼ í„´ ìˆ˜ (ì»¨í…ìŠ¤íŠ¸ ëˆ„ì  ê³ ë ¤)</p>
                            <p>â€¢ <strong>ì›”ê°„ ë¹„ìš©:</strong> ì¼ì¼ ë¹„ìš© Ã— ì‚¬ìš©ì ìˆ˜ Ã— 30ì¼</p>
                            <p class="mt-2 text-gray-400">â€» ì»¨í…ìŠ¤íŠ¸ê°€ ëˆ„ì ë˜ë©´ì„œ ë¹„ìš©ì´ ì ì§„ì ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” ê²ƒì„ ë°˜ì˜í•©ë‹ˆë‹¤.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const modelPrices = {
            'claude-4.5-sonnet':      { input: 3.00,  output: 15.00, context: 200000 },
            'gemini-2.5-pro':         { input: 1.25,  output: 10.00, context: 1048576 },
            'gemini-2.5-flash':       { input: 0.30,  output: 2.50,  context: 1000000 },
            'grok-4-fast':            { input: 0.20,  output: 0.50,  context: 2000000 },
            'gemini-2.5-flash-lite':  { input: 0.10,  output: 0.40,  context: 1048576 }
        };
        const retrievalPrices = {
            'embedding': { cost: 0.10 },
            'ranking': { cost: 0.0 } 
        };
        const USD_TO_KRW = 1392;
        const LOREBOOK_DOCUMENT_TOKENS = 500;

        // Scenario presets
        const scenarioPresets = {
            'casual': { input: 30, output: 200, lorebook: false },
            'story': { input: 100, output: 600, lorebook: true },
            'roleplay': { input: 150, output: 400, lorebook: true },
            'custom': { input: 50, output: 800, lorebook: false }
        };

        // --- STATE ---
        let conversationHistory = [];
        let totalCostKRW = 0;
        let currentScenario = 'casual';

        // --- DOM ELEMENTS ---
        const dom = {
            modelSelect: document.getElementById('model-select'),
            contextLimitSelect: document.getElementById('context-limit-select'),
            systemPrompt: document.getElementById('system-prompt'),
            systemTokenCount: document.getElementById('system-token-count'),
            inputSlider: document.getElementById('input-slider'),
            inputSliderValue: document.getElementById('input-slider-value'),
            outputSlider: document.getElementById('output-slider'),
            outputSliderValue: document.getElementById('output-slider-value'),
            useLorebookCheckbox: document.getElementById('use-lorebook'),
            addTurnBtn: document.getElementById('add-turn-btn'),
            resetBtn: document.getElementById('reset-btn'),
            dailyTurns: document.getElementById('daily-turns'),
            
            preview: {
                cost: document.getElementById('preview-cost'),
                systemToken: document.getElementById('preview-system-token'),
                contextToken: document.getElementById('preview-context-token'),
                lorebookP: document.getElementById('preview-lorebook-p'),
                lorebookToken: document.getElementById('preview-lorebook-token'),
                userInputToken: document.getElementById('preview-user-input-token'),
                totalInputToken: document.getElementById('preview-total-input-token'),
                outputToken: document.getElementById('preview-output-token'),
            },
            
            summary: {
                totalCost: document.getElementById('summary-total-cost'),
                contextToken: document.getElementById('summary-context-token'),
                turnCount: document.getElementById('summary-turn-count'),
                historyLog: document.getElementById('history-log'),
            },
            
            monthly: {
                cost: document.getElementById('monthly-cost')
            },
            
            costBreakdown: {
                perTurnCost: document.getElementById('per-turn-cost'),
                perUserDailyCost: document.getElementById('per-user-daily-cost'),
                totalDailyCost: document.getElementById('total-daily-cost')
            }
        };

        // --- UTILITY FUNCTIONS ---
        const formatNumber = (num) => num.toLocaleString('ko-KR');
        const formatKRW = (num) => num.toLocaleString('ko-KR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

        // Token estimation with multiple methods
        function estimateTokens(text) {
            if (!text) return 0;
            
            // Try to use tiktoken if available
            if (typeof tiktoken !== 'undefined') {
                try {
                    const encoding = tiktoken.get_encoding("cl100k_base");
                    return encoding.encode(text).length;
                } catch (e) {
                    console.log("tiktoken not available, using fallback");
                }
            }
            
            // Fallback: Multiple estimation methods
            const koreanChars = (text.match(/[ê°€-í£]/g) || []).length;
            const englishWords = (text.match(/[a-zA-Z]+/g) || []).length;
            const otherChars = text.length - koreanChars - (text.match(/[a-zA-Z]+/g) || []).join('').length;
            const simpleEstimate = Math.ceil(koreanChars + (englishWords * 1.3) + (otherChars * 0.5));
            
            const charBasedEstimate = Math.ceil(text.length * 0.75);
            const words = text.split(/\s+/).filter(word => word.length > 0);
            const wordBasedEstimate = Math.ceil(words.length * 1.3);
            
            return Math.max(simpleEstimate, charBasedEstimate, wordBasedEstimate);
        }

        // Model-specific token counting
        function estimateTokensByModel(text, model) {
            if (!text) return 0;
            
            // Try tiktoken for OpenAI models
            if (model.includes('gpt') || model.includes('claude')) {
                if (typeof tiktoken !== 'undefined') {
                    try {
                        const encoding = tiktoken.get_encoding("cl100k_base");
                        return encoding.encode(text).length;
                    } catch (e) {
                        console.log("tiktoken failed, using fallback");
                    }
                }
            }
            
            // Fallback to general estimation
            return estimateTokens(text);
        }

        // More accurate token counting using tiktoken-like approach
        function estimateTokensAdvanced(text) {
            if (!text) return 0;
            
            // This is a simplified version of how tiktoken works
            let tokens = 0;
            let i = 0;
            
            while (i < text.length) {
                const char = text[i];
                
                // Korean characters (most common case)
                if (/[ê°€-í£]/.test(char)) {
                    tokens += 1;
                }
                // English letters
                else if (/[a-zA-Z]/.test(char)) {
                    // Count consecutive letters as one token
                    let wordLength = 0;
                    while (i < text.length && /[a-zA-Z]/.test(text[i])) {
                        wordLength++;
                        i++;
                    }
                    i--; // Adjust for the loop increment
                    tokens += Math.ceil(wordLength / 4); // Roughly 4 characters per token
                }
                // Numbers
                else if (/[0-9]/.test(char)) {
                    let numLength = 0;
                    while (i < text.length && /[0-9]/.test(text[i])) {
                        numLength++;
                        i++;
                    }
                    i--; // Adjust for the loop increment
                    tokens += Math.ceil(numLength / 3); // Roughly 3 digits per token
                }
                // Punctuation and spaces
                else {
                    tokens += 1;
                }
                
                i++;
            }
            
            return tokens;
        }

        function getSelectedValues() {
            const model = dom.modelSelect.value;
            const modelInfo = modelPrices[model];
            const contextLimit = parseFloat(dom.contextLimitSelect.value);
            const maxWindow = modelInfo.context * contextLimit;
            const systemTokens = estimateTokensByModel(dom.systemPrompt.value, model);
            
            return {
                model: model,
                maxWindow: maxWindow,
                systemTokens: systemTokens,
                inputTokens: parseInt(dom.inputSlider.value, 10),
                outputTokens: parseInt(dom.outputSlider.value, 10),
                useLorebook: dom.useLorebookCheckbox.checked,
            };
        }

        function calculateEffectiveContext(maxWindow) {
            let effectiveContext = 0;
            for (let i = conversationHistory.length - 1; i >= 0; i--) {
                const turnTokens = conversationHistory[i].input + conversationHistory[i].output;
                if (effectiveContext + turnTokens > maxWindow) {
                    break;
                }
                effectiveContext += turnTokens;
            }
            return effectiveContext;
        }

        function previewCost() {
            const { model, maxWindow, systemTokens, inputTokens, outputTokens, useLorebook } = getSelectedValues();
            const effectiveContext = calculateEffectiveContext(maxWindow);
            
            let lorebookTokens = 0;
            let retrievalCostKRW = 0;

            if (useLorebook) {
                lorebookTokens = LOREBOOK_DOCUMENT_TOKENS;
                const retrievalCostUSD = (lorebookTokens / 1_000_000) * (retrievalPrices.embedding.cost + retrievalPrices.ranking.cost);
                retrievalCostKRW = retrievalCostUSD * USD_TO_KRW;
            }

            const totalInputTokens = systemTokens + effectiveContext + inputTokens + lorebookTokens;

            const prices = modelPrices[model];
            const inputCostUSD = (totalInputTokens / 1_000_000) * prices.input;
            const outputCostUSD = (outputTokens / 1_000_000) * prices.output;
            const llmCostKRW = (inputCostUSD + outputCostUSD) * USD_TO_KRW;
            
            const turnCostKRW = llmCostKRW + retrievalCostKRW;

            // Update Preview UI
            dom.preview.cost.textContent = `${formatKRW(turnCostKRW)} ì›`;
            dom.preview.systemToken.textContent = `${formatNumber(systemTokens)}`;
            dom.preview.contextToken.textContent = `${formatNumber(effectiveContext)} / ${formatNumber(Math.floor(maxWindow))}`;
            dom.preview.userInputToken.textContent = formatNumber(inputTokens);
            dom.preview.totalInputToken.textContent = formatNumber(totalInputTokens);
            dom.preview.outputToken.textContent = formatNumber(outputTokens);

            if (useLorebook) {
                dom.preview.lorebookToken.textContent = formatNumber(lorebookTokens);
                dom.preview.lorebookP.classList.remove('hidden');
            } else {
                dom.preview.lorebookP.classList.add('hidden');
            }

            // Update monthly estimate
            updateMonthlyEstimate(turnCostKRW);
        }

        function updateMonthlyEstimate(turnCostKRW) {
            const dailyTurns = parseInt(dom.dailyTurns.value) || 100;
            const userCount = parseInt(document.getElementById('user-count').value) || 1;
            
            // í˜„ì¬ í„´ ë¹„ìš© (ë‹¤ìŒ í˜¸ì¶œ ë¹„ìš©)
            dom.costBreakdown.perTurnCost.textContent = `${formatKRW(turnCostKRW)}ì›`;
            
            // ì¼ì¼ ë¹„ìš© ê³„ì‚° - í‰ê·  ë¹„ìš© ë°©ì‹ ì‚¬ìš©
            const averageTurnCost = calculateAverageTurnCost(dailyTurns);
            const perUserDailyCost = averageTurnCost * dailyTurns;
            const totalDailyCost = perUserDailyCost * userCount;
            const monthlyCost = totalDailyCost * 30;
            
            // ë¹„ìš© ë¶„ì„ ì—…ë°ì´íŠ¸
            dom.costBreakdown.perUserDailyCost.textContent = `${formatKRW(perUserDailyCost)}ì›`;
            dom.costBreakdown.totalDailyCost.textContent = `${formatKRW(totalDailyCost)}ì›`;
            
            // ì›”ê°„ ë¹„ìš© ì—…ë°ì´íŠ¸
            dom.monthly.cost.textContent = `${formatKRW(monthlyCost)}ì›`;
        }

        function calculateAverageTurnCost(dailyTurns) {
            const { model, maxWindow, systemTokens, inputTokens, outputTokens, useLorebook } = getSelectedValues();
            const prices = modelPrices[model];
            
            let lorebookTokens = 0;
            let retrievalCostKRW = 0;
            
            if (useLorebook) {
                lorebookTokens = LOREBOOK_DOCUMENT_TOKENS;
                const retrievalCostUSD = (lorebookTokens / 1_000_000) * (retrievalPrices.embedding.cost + retrievalPrices.ranking.cost);
                retrievalCostKRW = retrievalCostUSD * USD_TO_KRW;
            }
            
            // ì¼ì¼ í„´ ìˆ˜ì— ë”°ë¥¸ í‰ê·  ì»¨í…ìŠ¤íŠ¸ í¬ê¸° ê³„ì‚°
            const averageContextPerTurn = Math.min(maxWindow / 2, (inputTokens + outputTokens) * dailyTurns / 2);
            const averageContextTokens = Math.min(averageContextPerTurn, maxWindow);
            
            const totalInputTokens = systemTokens + averageContextTokens + inputTokens + lorebookTokens;
            
            const inputCostUSD = (totalInputTokens / 1_000_000) * prices.input;
            const outputCostUSD = (outputTokens / 1_000_000) * prices.output;
            const llmCostKRW = (inputCostUSD + outputCostUSD) * USD_TO_KRW;
            
            return llmCostKRW + retrievalCostKRW;
        }

        function handleAddTurn() {
            const { model, maxWindow, systemTokens, inputTokens, outputTokens, useLorebook } = getSelectedValues();
            const effectiveContext = calculateEffectiveContext(maxWindow);
            
            let lorebookTokens = 0;
            let retrievalCostKRW = 0;

            if (useLorebook) {
                lorebookTokens = LOREBOOK_DOCUMENT_TOKENS;
                const retrievalCostUSD = (lorebookTokens / 1_000_000) * (retrievalPrices.embedding.cost + retrievalPrices.ranking.cost);
                retrievalCostKRW = retrievalCostUSD * USD_TO_KRW;
            }
            
            const totalInputTokens = systemTokens + effectiveContext + inputTokens + lorebookTokens;
            
            const prices = modelPrices[model];
            const inputCostUSD = (totalInputTokens / 1_000_000) * prices.input;
            const outputCostUSD = (outputTokens / 1_000_000) * prices.output;
            const llmCostKRW = (inputCostUSD + outputCostUSD) * USD_TO_KRW;
            
            const turnCostKRW = llmCostKRW + retrievalCostKRW;

            // Update state
            totalCostKRW += turnCostKRW;
            const newTurn = { 
                turn: conversationHistory.length + 1, 
                input: inputTokens, 
                output: outputTokens,
                usedLorebook: useLorebook 
            };
            conversationHistory.push(newTurn);
            
            // Update Summary UI
            const totalAccumulatedContext = conversationHistory.reduce((sum, turn) => sum + turn.input + turn.output, 0);
            dom.summary.totalCost.textContent = `${formatKRW(totalCostKRW)} ì›`;
            dom.summary.contextToken.textContent = formatNumber(totalAccumulatedContext);
            dom.summary.turnCount.textContent = formatNumber(conversationHistory.length);
            
            // Add to history log
            if (conversationHistory.length === 1) dom.summary.historyLog.innerHTML = "";
            const logEntry = document.createElement('p');
            const lorebookText = newTurn.usedLorebook ? ' <span class="text-purple-700 font-semibold">[+ë¡œì–´ë¶]</span>' : '';
            logEntry.innerHTML = `<strong>Turn ${newTurn.turn}:</strong> In ${formatNumber(newTurn.input)} / Out ${formatNumber(newTurn.output)}${lorebookText}`;
            dom.summary.historyLog.appendChild(logEntry);
            dom.summary.historyLog.scrollTop = dom.summary.historyLog.scrollHeight;

            // Refresh preview for the next turn
            previewCost();
        }

        function resetConversation() {
            conversationHistory = [];
            totalCostKRW = 0;
            
            dom.contextLimitSelect.value = "0.8";
            dom.useLorebookCheckbox.checked = false;
            dom.inputSlider.value = 50;
            dom.outputSlider.value = 800;
            dom.inputSliderValue.textContent = formatNumber(50);
            dom.outputSliderValue.textContent = formatNumber(800);

            dom.summary.historyLog.innerHTML = "<p>ì•„ì§ ëŒ€í™” ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
            dom.summary.totalCost.textContent = `${formatKRW(0)} ì›`;
            dom.summary.contextToken.textContent = formatNumber(0);
            dom.summary.turnCount.textContent = formatNumber(0);
            
            previewCost();
        }

        function applyScenario(scenario) {
            currentScenario = scenario;
            const preset = scenarioPresets[scenario];
            
            // Update UI elements
            dom.inputSlider.value = preset.input;
            dom.outputSlider.value = preset.output;
            dom.useLorebookCheckbox.checked = preset.lorebook;
            
            // Update display
            dom.inputSliderValue.textContent = formatNumber(preset.input);
            dom.outputSliderValue.textContent = formatNumber(preset.output);
            
            // Update scenario card selection
            document.querySelectorAll('.scenario-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-scenario="${scenario}"]`).classList.add('selected');
            
            previewCost();
        }

        // --- EVENT LISTENERS ---
        dom.addTurnBtn.addEventListener('click', handleAddTurn);
        dom.resetBtn.addEventListener('click', resetConversation);
        
        // Scenario selection
        document.querySelectorAll('.scenario-card').forEach(card => {
            card.addEventListener('click', () => {
                const scenario = card.dataset.scenario;
                applyScenario(scenario);
            });
        });
        
        // Listen for changes on select boxes and checkbox
        [
            dom.modelSelect, 
            dom.contextLimitSelect, 
            dom.useLorebookCheckbox,
            dom.dailyTurns,
            document.getElementById('user-count')
        ].forEach(el => {
            el.addEventListener('change', previewCost);
        });

        // System prompt token counting
        dom.systemPrompt.addEventListener('input', () => {
            const model = dom.modelSelect.value;
            const tokens = estimateTokensByModel(dom.systemPrompt.value, model);
            dom.systemTokenCount.textContent = formatNumber(tokens);
            previewCost();
        });

        // Listen for input on sliders for real-time updates
        dom.inputSlider.addEventListener('input', () => {
            dom.inputSliderValue.textContent = formatNumber(dom.inputSlider.value);
            previewCost();
        });

        dom.outputSlider.addEventListener('input', () => {
            dom.outputSliderValue.textContent = formatNumber(dom.outputSlider.value);
            previewCost();
        });

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize system prompt token count
            const model = dom.modelSelect.value;
            const initialTokens = estimateTokensByModel(dom.systemPrompt.value, model);
            dom.systemTokenCount.textContent = formatNumber(initialTokens);
            
            // Apply default scenario
            applyScenario('casual');
            
            // Initial preview
            previewCost();
        });
    </script>
</body>
</html>
